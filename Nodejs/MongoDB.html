<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB | 学习记录</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="This is a blog.">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.8c49e242.js" as="script"><link rel="preload" href="/assets/js/2.504ddaa2.js" as="script"><link rel="preload" href="/assets/js/10.0d745487.js" as="script"><link rel="prefetch" href="/assets/js/11.ce53300c.js"><link rel="prefetch" href="/assets/js/12.c5546096.js"><link rel="prefetch" href="/assets/js/13.499a9de3.js"><link rel="prefetch" href="/assets/js/14.54a4b463.js"><link rel="prefetch" href="/assets/js/15.51c57644.js"><link rel="prefetch" href="/assets/js/16.7b40957e.js"><link rel="prefetch" href="/assets/js/17.71d38b17.js"><link rel="prefetch" href="/assets/js/3.0517d834.js"><link rel="prefetch" href="/assets/js/4.bf772ee7.js"><link rel="prefetch" href="/assets/js/5.a70211f1.js"><link rel="prefetch" href="/assets/js/6.58598019.js"><link rel="prefetch" href="/assets/js/7.9807b0b7.js"><link rel="prefetch" href="/assets/js/8.1c0ad852.js"><link rel="prefetch" href="/assets/js/9.ba4d109d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/logo.jpg" alt="学习记录" class="logo"> <span class="site-name can-hide">学习记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/React/JSX.html" class="sidebar-link">JSX</a></li><li><a href="/React/组件.html" class="sidebar-link">组件</a></li><li><a href="/React/表单.html" class="sidebar-link">表单</a></li><li><a href="/React/路由.html" class="sidebar-link">路由</a></li><li><a href="/React/生命周期.html" class="sidebar-link">生命周期</a></li><li><a href="/React/Redux.html" class="sidebar-link">Redux</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Nodejs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Nodejs/基础.html" class="sidebar-link">基础</a></li><li><a href="/Nodejs/核心模块.html" class="sidebar-link">核心模块</a></li><li><a href="/Nodejs/通信.html" class="sidebar-link">通信</a></li><li><a href="/Nodejs/MongoDB.html" aria-current="page" class="active sidebar-link">MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Nodejs/MongoDB.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/Nodejs/MongoDB.html#连接" class="sidebar-link">连接</a></li><li class="sidebar-sub-header"><a href="/Nodejs/MongoDB.html#基本操作" class="sidebar-link">基本操作</a></li><li class="sidebar-sub-header"><a href="/Nodejs/MongoDB.html#高教操作" class="sidebar-link">高教操作</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> MongoDB</h1> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>brew tap mongodb/brew
brew <span class="token function">install</span> mongodb-community@4.4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="安装信息"><a href="#安装信息" class="header-anchor">#</a> 安装信息</h3> <ul><li>配置文件：<code>/usr/local/etc/mongod.conf</code></li> <li>日志文件路径：<code>/usr/local/var/log/mongodb</code></li> <li>数据存放路径：<code>/usr/local/var/mongodb</code></li></ul> <h3 id="brew-启动和暂停"><a href="#brew-启动和暂停" class="header-anchor">#</a> brew 启动和暂停</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>brew services start mongodb-community@4.4

brew services stop mongodb-community@4.4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="mongod-命令后台进程方式"><a href="#mongod-命令后台进程方式" class="header-anchor">#</a> mongod 命令后台进程方式</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mongod <span class="token operator">--</span>config <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>etc<span class="token operator">/</span>mongod<span class="token punctuation">.</span>conf

cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>Cellar<span class="token operator">/</span>mongodb<span class="token operator">-</span>community@<span class="token number">4.4</span><span class="token operator">/</span><span class="token number">4.4</span><span class="token number">.8</span><span class="token operator">/</span>bin
<span class="token punctuation">.</span><span class="token operator">/</span>mongo

或者

mongo <span class="token operator">--</span>version <span class="token comment">// 版本号</span>
mongo <span class="token comment">// 默认端口号</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="连接"><a href="#连接" class="header-anchor">#</a> 连接</h2> <h3 id="略"><a href="#略" class="header-anchor">#</a> 略</h3> <h2 id="基本操作"><a href="#基本操作" class="header-anchor">#</a> 基本操作</h2> <h3 id="创建和删除"><a href="#创建和删除" class="header-anchor">#</a> 创建和删除</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>use testdb1 <span class="token comment">// 创建</span>
db<span class="token punctuation">.</span>testdb1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;testdb1数据库&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 插入数据</span>
show dbs <span class="token comment">// 查看所有数据库</span>

db<span class="token punctuation">.</span><span class="token function">dropDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 删除数据库(进到当前数据库)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="创建集合和删除集合"><a href="#创建集合和删除集合" class="header-anchor">#</a> 创建集合和删除集合</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span><span class="token function">createCollection</span><span class="token punctuation">(</span><span class="token string">'db1'</span><span class="token punctuation">)</span> <span class="token comment">// 创建</span>
show tables <span class="token comment">// 查看</span>
<span class="token comment">// 或者</span>
db<span class="token punctuation">.</span>db2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;db1集合&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>db2<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 删除集合(如果删除成功返回true，否则为false)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="插入、更新、查看、删除文档"><a href="#插入、更新、查看、删除文档" class="header-anchor">#</a> 插入、更新、查看、删除文档</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 插入</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;我是标题&quot;</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">&quot;我是描述&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 或者</span>
data1 <span class="token operator">=</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;我是标题&quot;</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">&quot;我是描述&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 更新</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;我是标题&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;我是标题B&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 以上语句只会修改第一条发现的文档，如果你要修改多条相同的文档，则需要设置 multi 参数为 true。</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;我是标题&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;我是标题B&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> multi<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 删除</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除集合下全部文档</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除 title 等于 A 的全部文档</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;D&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除 title 等于 D 的一个文档</span>

<span class="token comment">// 查询</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pretty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 以易读的方式来读取数据</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="and、or"><a href="#and、or" class="header-anchor">#</a> AND、OR</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// MongoDB 的 find() 方法可以传入多个键(key)，每个键(key)以逗号隔开</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> key1<span class="token operator">:</span> value1<span class="token punctuation">,</span> key2<span class="token operator">:</span> value2 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pretty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>col<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&quot;我是标题&quot;</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">&quot;我是描述&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pretty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// OR 条件语句使用了关键字 $or</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
   <span class="token punctuation">{</span>
      $or<span class="token operator">:</span> <span class="token punctuation">[</span>
         <span class="token punctuation">{</span>key1<span class="token operator">:</span> value1<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>key2<span class="token operator">:</span>value2<span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pretty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>$or<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;我是标题&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;我是描述&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pretty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// and和or联合使用</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;likes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>$gt<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span> $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;我是标题&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;我是描述&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pretty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="条件操作符"><a href="#条件操作符" class="header-anchor">#</a> 条件操作符</h3> <h4 id="条件语句"><a href="#条件语句" class="header-anchor">#</a> 条件语句</h4> <table><thead><tr><th>操作</th> <th>格式</th> <th>范例</th></tr></thead> <tbody><tr><td>等于</td> <td><code>{&lt;key&gt;:&lt;value&gt;}</code></td> <td><code>db.col.find({&quot;title&quot;:&quot;我是标题&quot;})</code></td></tr> <tr><td>小于</td> <td><code>{&lt;key&gt;:{$lt:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$lt:50}})</code></td></tr> <tr><td>小于或等于</td> <td><code>{&lt;key&gt;:{$lte:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$lte:50}})</code></td></tr> <tr><td>大于</td> <td><code>{&lt;key&gt;:{$gt:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$gt:50}})</code></td></tr> <tr><td>大于或等于</td> <td><code>{&lt;key&gt;:{$gte:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$gte:50}})</code></td></tr> <tr><td>不等于</td> <td><code>{&lt;key&gt;:{$ne:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$ne:50}})</code></td></tr></tbody></table> <h3 id="limit-和-skip"><a href="#limit-和-skip" class="header-anchor">#</a> Limit 和 Skip</h3> <ul><li>limit(NUMBER)方法从 MongoDB 中读取的记录条数。</li> <li>skip(NUMBER)方法来跳过指定数量的数据。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 第一个 {} 放 where 条件，为空表示返回集合中所有文档。</span>
<span class="token comment">// 第二个 {} 指定那些列显示和不,显示 （0表示不显示 1表示显示)。</span>

db<span class="token punctuation">.</span>db1
  <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 读取从 10 条记录后 100 条记录</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="排序"><a href="#排序" class="header-anchor">#</a> 排序</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token constant">KEY</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 升序</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token constant">KEY</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 降序</span>
<span class="token comment">// skip(), limilt(), sort()三个放在一起执行的时候，</span>
<span class="token comment">// 执行的顺序是先 sort(), 然后是 skip()，最后是显示的 limit()</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 语法</span>
<span class="token comment">// Key 值为你要创建的索引字段，1 为指升序创建索引，-1为指定降序创建索引。</span>
db<span class="token punctuation">.</span>db1<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span> open<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> close<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> background<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 后台创建索引</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="聚合"><a href="#聚合" class="header-anchor">#</a> 聚合</h3> <h4 id="聚合-aggregate-主要用于处理数据-诸如统计平均值-求和等-并返回计算后的数据结果"><a href="#聚合-aggregate-主要用于处理数据-诸如统计平均值-求和等-并返回计算后的数据结果" class="header-anchor">#</a> 聚合(aggregate)主要用于处理数据(诸如统计平均值，求和等)，并返回计算后的数据结果</h4> <table><thead><tr><th>表达式</th> <th>描述</th> <th>实例</th></tr></thead> <tbody><tr><td><code>$sum</code></td> <td>计算总和。</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, num_tutorial : {$sum : &quot;$likes&quot;}}}])</code></td></tr> <tr><td><code>$avg</code></td> <td>计算平均值</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, num_tutorial : {$avg : &quot;$likes&quot;}}}])</code></td></tr> <tr><td><code>$min</code></td> <td>获取集合中所有文档对应值得最小值</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, num_tutorial : {$min : &quot;$likes&quot;}}}])</code></td></tr> <tr><td><code>$max</code></td> <td>获取集合中所有文档对应值得最大值</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, num_tutorial : {$max : &quot;$likes&quot;}}}])</code></td></tr> <tr><td><code>$push</code></td> <td>将值加入一个数组中，不会判断是否有重复的值</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, url : {$push: &quot;$url&quot;}}}])</code></td></tr> <tr><td><code>$addToSet</code></td> <td>将值加入一个数组中，会判断是否有重复的值，若相同的值在数组中已经存在了，则不加入</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, url : {$addToSet : &quot;$url&quot;}}}])</code></td></tr> <tr><td><code>$first</code></td> <td>根据资源文档的排序获取第一个文档数据</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, first_url : {$first : &quot;$url&quot;}}}])</code></td></tr> <tr><td><code>$last</code></td> <td>根据资源文档的排序获取最后一个文档数据</td> <td><code>db.db1.aggregate([{$group : {_id : &quot;$by_user&quot;, last_url : {$last : &quot;$url&quot;}}}])</code></td></tr></tbody></table> <h4 id="管道"><a href="#管道" class="header-anchor">#</a> 管道</h4> <ul><li><code>$project</code>：修改输入文档的结构。可以用来重命名、增加或删除域，也可以用于创建计算结果以及嵌套文档。</li> <li><code>$match</code>：用于过滤数据，只输出符合条件的文档。<code>$match</code> 使用 MongoDB 的标准查询操作。</li> <li><code>$limit</code>：用来限制 <code>MongoDB</code> 聚合管道返回的文档数。</li> <li><code>$skip</code>：在聚合管道中跳过指定数量的文档，并返回余下的文档。</li> <li><code>$unwind</code>：将文档中的某一个数组类型字段拆分成多条，每条包含数组中的一个值。</li> <li><code>$group</code>：将集合中的文档分组，可用于统计结果。</li> <li><code>$sort</code>：将输入文档排序后输出。</li> <li><code>$geoNear</code>：输出接近某一地理位置的有序文档。</li></ul> <h4 id="nodejs-中使用"><a href="#nodejs-中使用" class="header-anchor">#</a> NodeJs 中使用</h4> <p><a href="https://www.runoob.com/nodejs/nodejs-mongodb.html" target="_blank" rel="noopener noreferrer">链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://docs.mongodb.com/drivers/node/current/quick-start/" target="_blank" rel="noopener noreferrer">链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="高教操作"><a href="#高教操作" class="header-anchor">#</a> 高教操作</h2> <p>1
2
3</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Nodejs/通信.html" class="prev">
        通信
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8c49e242.js" defer></script><script src="/assets/js/2.504ddaa2.js" defer></script><script src="/assets/js/10.0d745487.js" defer></script>
  </body>
</html>
